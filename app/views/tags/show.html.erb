<!-- Hero Section -->
<div class="relative bg-gradient-to-br from-emerald-900 via-green-900 to-teal-900 py-16">
  <div class="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PHBhdGggZD0iTTM2IDEzNGg4djhoLTh6TTI4IDE0Mmg4djhoLTh6TTQ0IDE0Mmg4djhoLTh6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-20"></div>
  
  <div class="relative mx-auto px-6 sm:px-8 lg:px-12 xl:px-16 2xl:px-24 max-w-[1800px]">
    <div class="text-center">
      <div class="inline-flex items-center gap-3 mb-4 px-4 py-2 rounded-full bg-white/10 backdrop-blur-md border border-white/20">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-green-300">
          <path fill-rule="evenodd" d="M5.5 3A2.5 2.5 0 0 0 3 5.5v2.879a2.5 2.5 0 0 0 .732 1.767l6.5 6.5a2.5 2.5 0 0 0 3.536 0l2.878-2.878a2.5 2.5 0 0 0 0-3.536l-6.5-6.5A2.5 2.5 0 0 0 8.38 3H5.5ZM6 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" clip-rule="evenodd" />
        </svg>
        <span class="text-sm font-bold text-white uppercase tracking-wider">Tag</span>
      </div>
      
      <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-3">
        #<%= @tag.name %>
      </h1>
      
      <p class="text-lg text-green-100">
        Ranking completo de influencers por rendimiento
      </p>
    </div>
  </div>
</div>

<!-- Rankings Tables -->
<div class="bg-gradient-to-b from-gray-50 to-white py-12">
  <div class="mx-auto px-6 sm:px-8 lg:px-12 xl:px-16 2xl:px-24 max-w-[1800px] space-y-16">
    
    <!-- Top por Seguidores -->
    <section class="relative">
      <div class="mb-8 flex items-center gap-4">
        <div class="flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-white">
            <path d="M4.5 6.375a4.125 4.125 0 1 1 8.25 0 4.125 4.125 0 0 1-8.25 0ZM14.25 8.625a3.375 3.375 0 1 1 6.75 0 3.375 3.375 0 0 1-6.75 0ZM1.5 19.125a7.125 7.125 0 0 1 14.25 0v.003l-.001.119a.75.75 0 0 1-.363.63 13.067 13.067 0 0 1-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 0 1-.364-.63l-.001-.122ZM17.25 19.128l-.001.144a2.25 2.25 0 0 1-.233.96 10.088 10.088 0 0 0 5.06-1.01.75.75 0 0 0 .42-.643 4.875 4.875 0 0 0-6.957-4.611 8.586 8.586 0 0 1 1.71 5.157v.003Z" />
          </svg>
        </div>
        <div>
          <h2 class="text-3xl font-bold text-gray-900">Top por Seguidores</h2>
          <p class="text-sm text-gray-600">Influencers con mayor audiencia</p>
        </div>
      </div>
      
      <div class="overflow-hidden rounded-2xl bg-white shadow-xl ring-1 ring-gray-900/5">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
              <tr>
                <th scope="col" class="py-4 pl-6 pr-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700">Perfil</th>
                <th scope="col" class="px-3 py-4 text-right text-xs font-semibold uppercase tracking-wider text-gray-700">
                  <div class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-100">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 text-blue-700">
                      <path d="M10 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM6 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM1.49 15.326a.78.78 0 0 1-.358-.442 3 3 0 0 1 4.308-3.516 6.484 6.484 0 0 0-1.905 3.959c-.023.222-.014.442.025.654a4.97 4.97 0 0 1-2.07-.655ZM16.44 15.98a4.97 4.97 0 0 0 2.07-.654.78.78 0 0 0 .357-.442 3 3 0 0 0-4.308-3.517 6.484 6.484 0 0 1 1.907 3.96 2.32 2.32 0 0 1-.026.654ZM18 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM5.304 16.19a.844.844 0 0 1-.277-.71 5 5 0 0 1 9.947 0 .843.843 0 0 1-.277.71A6.975 6.975 0 0 1 10 18a6.974 6.974 0 0 1-4.696-1.81Z" />
                    </svg>
                    <span class="text-blue-700">Seguidores</span>
                  </div>
                </th>
                <th scope="col" class="px-3 py-4 text-right text-xs font-semibold uppercase tracking-wider text-gray-700">Engagement</th>
                <th scope="col" class="px-3 py-4 text-right text-xs font-semibold uppercase tracking-wider text-gray-700">Videos</th>
                <th scope="col" class="px-3 py-4 text-center text-xs font-semibold uppercase tracking-wider text-gray-700">Categoría</th>
                <th scope="col" class="px-3 py-4 text-left text-xs font-semibold uppercase tracking-wider text-gray-700">Tags</th>
                <th scope="col" class="px-3 py-4 text-center text-xs font-semibold uppercase tracking-wider text-gray-700">Verificada</th>
                <th scope="col" class="px-3 py-4 text-center text-xs font-semibold uppercase tracking-wider text-gray-700">Business</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100 bg-white">
              <%= render partial: "profiles/profile_table", collection: @profiles, as: :profile, locals: { highlight: "followers" } %>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Top por Interacciones -->
    <section class="relative">
      <div class="mb-8 flex items-center gap-4">
        <div class="flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-green-500 to-emerald-600 shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-white">
            <path d="M7.493 18.5c-.425 0-.82-.236-.975-.632A7.48 7.48 0 0 1 6 15.125c0-1.75.599-3.358 1.602-4.634.151-.192.373-.309.6-.397.473-.183.89-.514 1.212-.924a9.042 9.042 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75A.75.75 0 0 1 15 2a2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H14.23c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23h-.777ZM2.331 10.727a11.969 11.969 0 0 0-.831 4.398 12 12 0 0 0 .52 3.507C2.28 19.482 3.105 20 3.994 20H4.9c.445 0 .72-.498.523-.898a8.963 8.963 0 0 1-.924-3.977c0-1.708.476-3.305 1.302-4.666.245-.403-.028-.959-.5-.959H4.25c-.832 0-1.612.453-1.918 1.227Z" />
          </svg>
        </div>
        <div>
          <h2 class="text-3xl font-bold text-gray-900">Top por Engagement</h2>
          <p class="text-sm text-gray-600">Mayor interacción con su audiencia</p>
        </div>
      </div>
      
      <div class="overflow-hidden rounded-2xl bg-white shadow-xl ring-1 ring-gray-900/5">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
              <tr>
                <th scope="col" class="py-4 pl-6 pr-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700">Perfil</th>
                <th scope="col" class="px-3 py-4 text-right text-xs font-semibold uppercase tracking-wider text-gray-700">Seguidores</th>
                <th scope="col" class="px-3 py-4 text-right text-xs font-semibold uppercase tracking-wider text-gray-700">
                  <div class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-green-100">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 text-green-700">
                      <path d="M1 8.25a1.25 1.25 0 1 1 2.5 0v7.5a1.25 1.25 0 1 1-2.5 0v-7.5ZM11 3V1.7c0-.268.14-.526.395-.607A2 2 0 0 1 14 3c0 .995-.182 1.948-.514 2.826-.204.54.166 1.174.744 1.174h2.52c1.243 0 2.261 1.01 2.146 2.247a23.864 23.864 0 0 1-1.341 5.974C17.153 16.323 16.072 17 14.9 17h-3.192a3 3 0 0 1-1.341-.317l-2.734-1.366A3 3 0 0 0 6.292 15H5V8h.963c.685 0 1.258-.483 1.612-1.068a4.011 4.011 0 0 1 2.166-1.73c.432-.143.853-.386 1.011-.814.16-.432.248-.9.248-1.388Z" />
                    </svg>
                    <span class="text-green-700">Interacciones</span>
                  </div>
                </th>
                <th scope="col" class="px-3 py-4 text-right text-xs font-semibold uppercase tracking-wider text-gray-700">Videos</th>
                <th scope="col" class="px-3 py-4 text-center text-xs font-semibold uppercase tracking-wider text-gray-700">Categoría</th>
                <th scope="col" class="px-3 py-4 text-left text-xs font-semibold uppercase tracking-wider text-gray-700">Tags</th>
                <th scope="col" class="px-3 py-4 text-center text-xs font-semibold uppercase tracking-wider text-gray-700">Verificada</th>
                <th scope="col" class="px-3 py-4 text-center text-xs font-semibold uppercase tracking-wider text-gray-700">Business</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100 bg-white">
              <%= render partial: "profiles/profile_table", collection: @profiles_interactions, as: :profile, locals: { highlight: "interactions" } %>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Top por Videos -->
    <section class="relative">
      <div class="mb-8 flex items-center gap-4">
        <div class="flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-pink-600 shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-white">
            <path d="M4.5 4.5a3 3 0 0 0-3 3v9a3 3 0 0 0 3 3h8.25a3 3 0 0 0 3-3v-9a3 3 0 0 0-3-3H4.5ZM19.94 18.75l-2.69-2.69V7.94l2.69-2.69c.944-.945 2.56-.276 2.56 1.06v11.38c0 1.336-1.616 2.005-2.56 1.06Z" />
          </svg>
        </div>
        <div>
          <h2 class="text-3xl font-bold text-gray-900">Top por Videos</h2>
          <p class="text-sm text-gray-600">Videos más vistos del tag</p>
        </div>
      </div>
      
      <div class="overflow-hidden rounded-2xl bg-white shadow-xl ring-1 ring-gray-900/5">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
              <tr>
                <th scope="col" class="py-4 pl-6 pr-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700">Perfil</th>
                <th scope="col" class="px-3 py-4 text-right text-xs font-semibold uppercase tracking-wider text-gray-700">Seguidores</th>
                <th scope="col" class="px-3 py-4 text-right text-xs font-semibold uppercase tracking-wider text-gray-700">Engagement</th>
                <th scope="col" class="px-3 py-4 text-right text-xs font-semibold uppercase tracking-wider text-gray-700">
                  <div class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-purple-100">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 text-purple-700">
                      <path d="M3.25 4A2.25 2.25 0 0 0 1 6.25v7.5A2.25 2.25 0 0 0 3.25 16h7.5A2.25 2.25 0 0 0 13 13.75v-7.5A2.25 2.25 0 0 0 10.75 4h-7.5ZM19 4.75a.75.75 0 0 0-1.28-.53l-3 3a.75.75 0 0 0-.22.53v4.5c0 .199.079.39.22.53l3 3a.75.75 0 0 0 1.28-.53V4.75Z" />
                    </svg>
                    <span class="text-purple-700">Vistas</span>
                  </div>
                </th>
                <th scope="col" class="px-3 py-4 text-center text-xs font-semibold uppercase tracking-wider text-gray-700">Categoría</th>
                <th scope="col" class="px-3 py-4 text-left text-xs font-semibold uppercase tracking-wider text-gray-700">Tags</th>
                <th scope="col" class="px-3 py-4 text-center text-xs font-semibold uppercase tracking-wider text-gray-700">Verificada</th>
                <th scope="col" class="px-3 py-4 text-center text-xs font-semibold uppercase tracking-wider text-gray-700">Business</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100 bg-white">
              <%= render partial: "profiles/profile_table", collection: @profiles_video_views, as: :profile, locals: { highlight: "videos" } %>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Analytics Section -->
    <section class="relative mt-16">
      <div class="mb-8">
        <div class="flex items-center gap-4">
          <div class="flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-orange-500 to-red-600 shadow-lg">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-white">
              <path fill-rule="evenodd" d="M2.25 13.5a8.25 8.25 0 0 1 8.25-8.25.75.75 0 0 1 .75.75v6.75H18a.75.75 0 0 1 .75.75 8.25 8.25 0 0 1-16.5 0Z" clip-rule="evenodd" />
              <path fill-rule="evenodd" d="M12.75 3a.75.75 0 0 1 .75-.75 8.25 8.25 0 0 1 8.25 8.25.75.75 0 0 1-.75.75h-7.5a.75.75 0 0 1-.75-.75V3Z" clip-rule="evenodd" />
            </svg>
          </div>
          <div>
            <h2 class="text-3xl font-bold text-gray-900">Análisis y Estadísticas</h2>
            <p class="text-sm text-gray-600">Datos de la última semana</p>
          </div>
        </div>
      </div>

      <div class="space-y-8">
        <!-- Word Cloud -->
        <div class="overflow-hidden rounded-2xl bg-white shadow-xl ring-1 ring-gray-900/5 p-8">
          <div class="flex items-center gap-3 mb-6">
            <div class="flex items-center justify-center w-10 h-10 rounded-lg bg-gradient-to-br from-pink-500 to-rose-600">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-white">
                <path fill-rule="evenodd" d="M4.5 2A1.5 1.5 0 0 0 3 3.5v13A1.5 1.5 0 0 0 4.5 18h11a1.5 1.5 0 0 0 1.5-1.5V7.621a1.5 1.5 0 0 0-.44-1.06l-4.12-4.122A1.5 1.5 0 0 0 11.378 2H4.5Zm2.25 8.5a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Zm0 3a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Z" clip-rule="evenodd" />
              </svg>
            </div>
            <div>
              <h3 class="text-xl font-bold text-gray-900">Nube de Palabras</h3>
              <p class="text-sm text-gray-600">Palabras más utilizadas en los posts</p>
            </div>
          </div>
          <div class="mt-6">
            <%= render 'instagram_post/word_cloud', word_array: @posts.word_occurrences %>
          </div>
        </div>

        <!-- Posts per Day Chart -->
        <div class="overflow-hidden rounded-2xl bg-white shadow-xl ring-1 ring-gray-900/5 p-8">
          <div class="flex items-center gap-3 mb-6">
            <div class="flex items-center justify-center w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-600">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-white">
                <path d="M15.98 1.804a1 1 0 0 0-1.96 0l-.24 1.192a1 1 0 0 1-.784.785l-1.192.238a1 1 0 0 0 0 1.962l1.192.238a1 1 0 0 1 .785.785l.238 1.192a1 1 0 0 0 1.962 0l.238-1.192a1 1 0 0 1 .785-.785l1.192-.238a1 1 0 0 0 0-1.962l-1.192-.238a1 1 0 0 1-.785-.785l-.238-1.192ZM6.949 5.684a1 1 0 0 0-1.898 0l-.683 2.051a1 1 0 0 1-.633.633l-2.051.683a1 1 0 0 0 0 1.898l2.051.684a1 1 0 0 1 .633.632l.683 2.051a1 1 0 0 0 1.898 0l.683-2.051a1 1 0 0 1 .633-.633l2.051-.683a1 1 0 0 0 0-1.898l-2.051-.683a1 1 0 0 1-.633-.633L6.95 5.684ZM13.949 13.684a1 1 0 0 0-1.898 0l-.184.551a1 1 0 0 1-.632.633l-.551.183a1 1 0 0 0 0 1.898l.551.183a1 1 0 0 1 .633.633l.183.551a1 1 0 0 0 1.898 0l.184-.551a1 1 0 0 1 .632-.633l.551-.183a1 1 0 0 0 0-1.898l-.551-.184a1 1 0 0 1-.633-.632l-.183-.551Z" />
              </svg>
            </div>
            <div>
              <h3 class="text-xl font-bold text-gray-900">Posteos por Día</h3>
              <p class="text-sm text-gray-600">Distribución de contenido publicado</p>
            </div>
          </div>
          <div class="mt-6">
            <%= column_chart @posts.group(:media).group_by_day(:posted_at).count, label: "Posteos", xtitle: "Fecha", ytitle: "Cant. Posteos", stacked: true %>
          </div>
        </div>

        <!-- Interactions Chart -->
        <div class="overflow-hidden rounded-2xl bg-white shadow-xl ring-1 ring-gray-900/5 p-8">
          <div class="flex items-center gap-3 mb-6">
            <div class="flex items-center justify-center w-10 h-10 rounded-lg bg-gradient-to-br from-green-500 to-emerald-600">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-white">
                <path d="M1 8.25a1.25 1.25 0 1 1 2.5 0v7.5a1.25 1.25 0 1 1-2.5 0v-7.5ZM11 3V1.7c0-.268.14-.526.395-.607A2 2 0 0 1 14 3c0 .995-.182 1.948-.514 2.826-.204.54.166 1.174.744 1.174h2.52c1.243 0 2.261 1.01 2.146 2.247a23.864 23.864 0 0 1-1.341 5.974C17.153 16.323 16.072 17 14.9 17h-3.192a3 3 0 0 1-1.341-.317l-2.734-1.366A3 3 0 0 0 6.292 15H5V8h.963c.685 0 1.258-.483 1.612-1.068a4.011 4.011 0 0 1 2.166-1.73c.432-.143.853-.386 1.011-.814.16-.432.248-.9.248-1.388Z" />
              </svg>
            </div>
            <div>
              <h3 class="text-xl font-bold text-gray-900">Interacciones por Día</h3>
              <p class="text-sm text-gray-600">Likes y comentarios combinados (vistas de videos es métrica aparte)</p>
            </div>
          </div>
          <div class="mt-6">
            <%= column_chart @posts.group_by_day(:posted_at).sum(:total_count), colors: ['#10b981'], label: "Interacciones", xtitle: "Fecha", ytitle: "Cant. Interacciones", thousands: "." %>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
