<%if profile.avatar.attached?%>
  <div class="group relative">
    <!-- Card Container -->
    <div class="relative overflow-hidden rounded-2xl bg-white shadow-md ring-1 ring-gray-900/5 transition-all duration-500 hover:shadow-2xl hover:-translate-y-2">
      
      <!-- Image Container with Overlay -->
      <div class="relative aspect-square w-full overflow-hidden bg-gradient-to-br from-gray-100 to-gray-200">
        <%=link_to profile_path(profile), class: 'block h-full w-full' do%>
                <%= image_tag(direct_blob_url(profile.avatar), 
                  class: 'h-full w-full object-cover object-center transition-all duration-700 group-hover:scale-110 group-hover:brightness-110',
                  loading: 'lazy',
                  decoding: 'async',
                  alt: "#{profile.full_name} - Influencer #{profile.profile_type&.capitalize} en Paraguay"
                ) %>
          
          <!-- Gradient Overlay for better text visibility -->
          <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
          
          <!-- Verified Badge - Premium Position -->
          <% if profile.is_verified %>
            <div class="absolute top-4 right-4 z-20">
              <div class="relative">
                <!-- Glow Effect -->
                <div class="absolute inset-0 rounded-full bg-blue-500 blur-lg opacity-60 animate-pulse"></div>
                <!-- Badge -->
                <div class="relative flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-xl border-2 border-blue-100">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="#0095f6" class="w-6 h-6">
                    <path fill-rule="evenodd" d="M16.403 12.652a3 3 0 0 0 0-5.304 3 3 0 0 0-3.75-3.751 3 3 0 0 0-5.305 0 3 3 0 0 0-3.751 3.75 3 3 0 0 0 0 5.305 3 3 0 0 0 3.75 3.751 3 3 0 0 0 5.305 0 3 3 0 0 0 3.751-3.75Zm-2.546-4.46a.75.75 0 0 0-1.214-.883l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z" clip-rule="evenodd" />
                  </svg>
                </div>
              </div>
            </div>
          <% end %>
          
          <!-- Hover Stats Overlay - Premium Info -->
          <div class="absolute inset-x-0 bottom-0 z-10 p-6 transform translate-y-full group-hover:translate-y-0 transition-transform duration-500">
            <div class="space-y-3">
              <!-- Followers Badge -->
              <% if profile.followers.present? %>
                <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/95 backdrop-blur-md shadow-xl border border-white/20">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-blue-600">
                    <path d="M10 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM6 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM1.49 15.326a.78.78 0 0 1-.358-.442 3 3 0 0 1 4.308-3.516 6.484 6.484 0 0 0-1.905 3.959c-.023.222-.014.442.025.654a4.97 4.97 0 0 1-2.07-.655ZM16.44 15.98a4.97 4.97 0 0 0 2.07-.654.78.78 0 0 0 .357-.442 3 3 0 0 0-4.308-3.517 6.484 6.484 0 0 1 1.907 3.96 2.32 2.32 0 0 1-.026.654ZM18 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM5.304 16.19a.844.844 0 0 1-.277-.71 5 5 0 0 1 9.947 0 .843.843 0 0 1-.277.71A6.975 6.975 0 0 1 10 18a6.974 6.974 0 0 1-4.696-1.81Z" />
                  </svg>
                  <span class="text-sm font-bold text-gray-900">
                    <%= number_to_human(profile.followers, format: '%n%u', units: { thousand: 'K', million: 'M', billion: 'B' }, precision: 1) %>
                  </span>
                  <span class="text-xs font-medium text-gray-600">seguidores</span>
                </div>
              <% end %>
              
              <!-- Engagement Rate Badge -->
              <% if profile.engagement_rate.present? && profile.engagement_rate > 0 %>
                <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-green-500 to-emerald-600 shadow-xl">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-white">
                    <path d="M1 8.25a1.25 1.25 0 1 1 2.5 0v7.5a1.25 1.25 0 1 1-2.5 0v-7.5ZM11 3V1.7c0-.268.14-.526.395-.607A2 2 0 0 1 14 3c0 .995-.182 1.948-.514 2.826-.204.54.166 1.174.744 1.174h2.52c1.243 0 2.261 1.01 2.146 2.247a23.864 23.864 0 0 1-1.341 5.974C17.153 16.323 16.072 17 14.9 17h-3.192a3 3 0 0 1-1.341-.317l-2.734-1.366A3 3 0 0 0 6.292 15H5V8h.963c.685 0 1.258-.483 1.612-1.068a4.011 4.011 0 0 1 2.166-1.73c.432-.143.853-.386 1.011-.814.16-.432.248-.9.248-1.388Z" />
                  </svg>
                  <span class="text-sm font-bold text-white"><%= profile.engagement_rate %>%</span>
                  <span class="text-xs font-medium text-green-100">engagement</span>
                </div>
              <% end %>
            </div>
          </div>
        <%end%>
      </div>
      
      <!-- Content Section - Enhanced -->
      <div class="relative p-6 bg-gradient-to-b from-white to-gray-50">
        <div class="space-y-3">
          <!-- Name with subtle icon -->
          <div class="flex items-start justify-between gap-3">
            <div class="flex-1 min-w-0">
              <h3 class="text-lg font-bold text-gray-900 truncate leading-tight">
                <%=link_to profile_path(profile), class: 'hover:text-blue-600 transition-colors' do%>
                  <%=profile.full_name%>
                <%end%>
              </h3>
              
              <!-- Username with Instagram icon -->
              <div class="mt-1.5 flex items-center gap-1.5">
                <%= link_to "https://www.instagram.com/#{profile.username}", 
                  target: "_blank", 
                  rel: "noopener",
                  class: 'group/username inline-flex items-center gap-1.5 text-sm text-gray-600 hover:text-blue-600 transition-colors' do %>
                  <div class="relative">
                    <div class="absolute inset-0 bg-gradient-to-r from-purple-600 via-pink-600 to-orange-500 rounded blur-sm opacity-0 group-hover/username:opacity-75 transition-opacity"></div>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="relative w-4 h-4">
                      <path d="M12.378 1.602a.75.75 0 00-.756 0L3 6.632l9 5.25 9-5.25-8.622-5.03zM21.75 7.93l-9 5.25v9l8.628-5.032a.75.75 0 00.372-.648V7.93zM11.25 22.18v-9l-9-5.25v8.57a.75.75 0 00.372.648l8.628 5.033z" />
                    </svg>
                  </div>
                  <span class="font-medium">@<%= profile.username %></span>
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3.5 h-3.5 opacity-0 -translate-x-1 group-hover/username:opacity-100 group-hover/username:translate-x-0 transition-all">
                    <path fill-rule="evenodd" d="M3 10a.75.75 0 0 1 .75-.75h10.638L10.23 5.29a.75.75 0 1 1 1.04-1.08l5.5 5.25a.75.75 0 0 1 0 1.08l-5.5 5.25a.75.75 0 1 1-1.04-1.08l4.158-3.96H3.75A.75.75 0 0 1 3 10Z" clip-rule="evenodd" />
                  </svg>
                <% end %>
              </div>
            </div>
          </div>
          
          <!-- Stats Bar - Quick Info -->
          <% if profile.followers.present? %>
            <div class="flex items-center gap-3 pt-3 border-t border-gray-200">
              <!-- Followers -->
              <div class="flex items-center gap-1.5">
                <div class="flex items-center justify-center w-7 h-7 rounded-lg bg-blue-50">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 text-blue-600">
                    <path d="M10 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM6 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM1.49 15.326a.78.78 0 0 1-.358-.442 3 3 0 0 1 4.308-3.516 6.484 6.484 0 0 0-1.905 3.959c-.023.222-.014.442.025.654a4.97 4.97 0 0 1-2.07-.655ZM16.44 15.98a4.97 4.97 0 0 0 2.07-.654.78.78 0 0 0 .357-.442 3 3 0 0 0-4.308-3.517 6.484 6.484 0 0 1 1.907 3.96 2.32 2.32 0 0 1-.026.654ZM18 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM5.304 16.19a.844.844 0 0 1-.277-.71 5 5 0 0 1 9.947 0 .843.843 0 0 1-.277.71A6.975 6.975 0 0 1 10 18a6.974 6.974 0 0 1-4.696-1.81Z" />
                  </svg>
                </div>
                <div class="flex flex-col">
                  <span class="text-xs font-bold text-gray-900 leading-none">
                    <%= number_to_human(profile.followers, format: '%n%u', units: { thousand: 'K', million: 'M', billion: 'B' }, precision: 1) %>
                  </span>
                  <span class="text-[10px] text-gray-500 leading-none mt-0.5">followers</span>
                </div>
              </div>
              
              <!-- Engagement Rate if available -->
              <% if profile.engagement_rate.present? && profile.engagement_rate > 0 %>
                <div class="flex items-center gap-1.5">
                  <div class="flex items-center justify-center w-7 h-7 rounded-lg bg-green-50">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 text-green-600">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm.75-11.25a.75.75 0 0 0-1.5 0v2.5h-2.5a.75.75 0 0 0 0 1.5h2.5v2.5a.75.75 0 0 0 1.5 0v-2.5h2.5a.75.75 0 0 0 0-1.5h-2.5v-2.5Z" clip-rule="evenodd" />
                    </svg>
                  </div>
                  <div class="flex flex-col">
                    <span class="text-xs font-bold text-gray-900 leading-none"><%= profile.engagement_rate %>%</span>
                    <span class="text-[10px] text-gray-500 leading-none mt-0.5">engagement</span>
                  </div>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
      
      <!-- Animated Border on Hover -->
      <div class="absolute inset-0 rounded-2xl ring-2 ring-blue-500 opacity-0 scale-95 group-hover:opacity-100 group-hover:scale-100 transition-all duration-500 pointer-events-none"></div>
      
      <!-- Corner Accent -->
      <div class="absolute -top-1 -right-1 w-20 h-20 bg-gradient-to-br from-blue-500/10 to-purple-500/10 rounded-full blur-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
    </div>
  </div>
<%end%>
